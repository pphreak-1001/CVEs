import csv
import random
from datetime import datetime, timedelta

# Configuration
NUM_ENTRIES = 1000
OUTPUT_FILE = 'sales_data.csv'

# Data options
products = ['Product A', 'Product B', 'Product C', 'Product D', 'Product E']
regions = ['North', 'South', 'East', 'West', 'Central']

def generate_dummy_data():
    # Start date for data generation
    current_date = datetime(2023, 1, 1)
    end_date = datetime(2023, 12, 31)
    
    with open(OUTPUT_FILE, 'w', newline='') as csvfile:
        writer = csv.writer(csvfile)  # Default delimiter is comma
        
        # Write header
        writer.writerow(['Date', 'Product', 'Region', 'Units Sold', 'Revenue'])
        
        for _ in range(NUM_ENTRIES):
            # Randomize date within 2023
            random_days = random.randint(0, (end_date - current_date).days)
            date = (current_date + timedelta(days=random_days)).strftime('%Y-%m-%d')
            
            product = random.choice(products)
            region = random.choice(regions)
            
            # Generate realistic units sold
            base_units = random.randint(50, 300)
            
            # Adjust for product variations
            if product == 'Product A':
                units = base_units + random.randint(-20, 50)
            elif product == 'Product B':
                units = base_units + random.randint(-30, 40)
            elif product == 'Product C':
                units = base_units + random.randint(0, 100)
            else:
                units = base_units + random.randint(-50, 30)
            
            # Adjust for regional variations
            if region == 'North':
                units = int(units * 1.2)
            elif region == 'South':
                units = int(units * 0.9)
            
            units = max(10, units)  # Ensure at least 10 units
            
            # Calculate revenue (with some randomness in unit price)
            if product == 'Product A':
                unit_price = random.uniform(45, 55)
            elif product == 'Product B':
                unit_price = random.uniform(35, 45)
            elif product == 'Product C':
                unit_price = random.uniform(25, 35)
            elif product == 'Product D':
                unit_price = random.uniform(15, 25)
            else:  # Product E
                unit_price = random.uniform(5, 15)
            
            revenue = units * unit_price
            
            # Format revenue as currency (without dollar sign to avoid CSV parsing issues)
            revenue_formatted = f"{revenue:,.2f}"
            
            writer.writerow([date, product, region, units, revenue_formatted])

if __name__ == '__main__':
    generate_dummy_data()
    print(f"âœ… Generated {NUM_ENTRIES} entries in {OUTPUT_FILE} (comma-separated)")