
# CVE-2025-0133 - Reflected Cross-Site Scripting in Palo Alto PAN-OS GlobalProtect Portal

**Initially Found by:** XBOW [AI based security research agent from US]

---

## 1. Vulnerability Overview

CVE-2025-0133 is a Reflected Cross-Site Scripting (XSS) vulnerability affecting the GlobalProtect gateway and portal features of Palo Alto Networks' PAN-OS software. It allows an attacker to inject malicious JavaScript into a URL parameter, which gets reflected back to the victimâ€™s browser without proper sanitization or encoding.

The vulnerability requires user interaction (i.e., clicking a crafted URL) and is more impactful if the **Clientless VPN** feature is enabled, which increases the potential for credential theft via phishing.

### Affected Components:
* GlobalProtect Gateway/Portal
* PAN-OS versions:
    * `< 11.2.7`
    * `< 11.1.11` [ETA Sep 2025]
    * `< 10.2.17` [ETA Oct 2025]
    * All versions of 10.1 (EOL)

### Severity:
* **Without Clientless VPN:** LOW (CVSSv4.0 Base: 5.1, Threat: 2.0)
* **With Clientless VPN:** MEDIUM (CVSSv4.0 Base: 6.9, Threat: 5.5)

---

## 2. Root Cause Analysis

The vulnerable endpoint (`/ssl-vpn/getconfig.esp`) reflects the value of the "user" parameter directly into the XML response body without:
* Input validation or filtering
* Output encoding or sanitization

As a result, attackers can inject payloads such as:
```xml
<svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)"><script>prompt('Defhawk')</script></svg>
````

This is then rendered inside an XML element as:

```xml
<user><svg>...</svg></user>
```

Modern browsers may interpret and execute this as HTML/JS when the page is previewed or embedded (e.g., using XMLHttpRequest or embedded in an iframe).

-----

## 3\. Proof of Concept (PoC)

<img width="1366" height="768" alt="image" src="https://github.com/user-attachments/assets/68dcafb1-dd83-4946-942e-3d4677b8574a" />


### Reflected Response Snippet:

```xml
<user><svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)"><script>prompt("Defhawk")</script></svg></user>
```

-----

## 4\. Mass Scanner / Auto Exploiter

To validate this CVE at scale, a custom Python-based scanner was developed by the author. It automates discovery of potentially vulnerable endpoints using **Hunter** and **Shodan** search APIs, constructs malicious URLs, and scans targets for reflected payloads.

### Key Features:

  * Fetches up to 500 IPs per day using both Hunter and Shodan
  * Builds and injects the XSS payload into the vulnerable endpoint
  * Detects success based on presence of payload reflection
  * Uses randomized batches to avoid rate limiting
  * Handles custom port logic (e.g., IP:PORT support)

### Payload Path Used:

`/ssl-vpn/getconfig.esp?client-type=1&...&user=<svg><script>prompt('Defhawk')</script></svg>`

### Scanner Logic Summary:

1.  Query Hunter and Shodan APIs for PAN-OS exposed IPs
2.  Construct the vulnerable URL for each IP
3.  Send GET request to the target with malicious payload
4.  Check if the payload is reflected in the response body
5.  Log results including status, URL, and reflection state

### Batch-based scanning:

  * Max pages per batch: 10
  * Max IPs per batch: \~500
  * Sleep time added to prevent throttling

## 5\. Resources
  * CVE Database: [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-0133](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-0133)
  * Palo Alto Advisory: [https://security.paloaltonetworks.com/CVE-2025-0133](https://security.paloaltonetworks.com/CVE-2025-0133)
